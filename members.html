<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Attendance Section</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #050505;
            --bg-secondary: #0c0c0c;
            --bg-card: #131313;
            --bg-card-hover: #1a1a1a;
            --accent: #ff3a4a;
            --accent-bright: #ff5a68;
            --accent-glow: rgba(255, 58, 74, 0.4);
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --text-muted: #888888;
            --border-color: #333333;
            --present: #00ff88;
            --present-dim: #00d970;
            --present-bg: rgba(0, 255, 136, 0.12);
            --present-border: rgba(0, 255, 136, 0.5);
            --present-glow: rgba(0, 255, 136, 0.4);
            --absent: #ff4466;
            --absent-dim: #ff2a50;
            --absent-bg: rgba(255, 68, 102, 0.12);
            --absent-border: rgba(255, 68, 102, 0.5);
            --absent-glow: rgba(255, 68, 102, 0.4);
            --energon-blue: #00e5ff;
            --energon-glow: rgba(0, 229, 255, 0.35);
            --streak-1: #7dffb3;
            --streak-2: #00ff6a;
            --streak-3: #00b4ff;
            --streak-4: #3d7aff;
            --streak-5: #ff4d6a;
            --streak-6: #1a1a1a;
            --graph-up: #00ff88;
            --graph-down: #ff4466;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
        }

        .attendance-section { max-width: 800px; margin: 0 auto; padding: 30px 20px; }

        .section-header { text-align: center; margin-bottom: 35px; position: relative; }
        .section-title { font-size: 2rem; font-weight: 800; margin-bottom: 8px; }
        .section-title span {
            background: linear-gradient(135deg, #ff3a4a, #ff7a85);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .section-subtitle { color: var(--text-secondary); font-size: 0.95rem; }

        .fullscreen-btn {
            position: absolute; top: 0; right: 0;
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 10px; padding: 10px 16px;
            color: var(--text-secondary); cursor: pointer;
            display: flex; align-items: center; gap: 8px;
            font-size: 0.85rem; font-weight: 600;
            transition: all 0.3s ease;
        }
        .fullscreen-btn:hover {
            border-color: var(--energon-blue); color: var(--energon-blue);
            box-shadow: 0 0 20px var(--energon-glow);
        }
        .fullscreen-btn svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; }

        .day-lock-container {
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 16px; padding: 20px; margin-bottom: 24px;
        }
        .day-lock-label { font-size: 0.7rem; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 14px; }
        .days-row { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; }
        .day-cell {
            position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 14px 8px; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: 12px; transition: all 0.3s ease;
        }
        .day-cell.locked { opacity: 0.4; }
        .day-cell.current { border-color: var(--accent); background: rgba(255, 58, 74, 0.1); box-shadow: 0 0 25px var(--accent-glow); }
        .day-cell.future { opacity: 0.55; }
        .day-name { font-size: 0.85rem; font-weight: 700; margin-bottom: 4px; }
        .day-cell.current .day-name { color: var(--accent-bright); }
        .day-cell-status { font-size: 0.6rem; color: var(--text-muted); text-transform: uppercase; }
        .day-cell.current .day-cell-status { color: var(--accent-bright); }
        .lock-badge { position: absolute; top: 6px; right: 6px; width: 14px; height: 14px; color: var(--text-muted); display: none; }
        .day-cell.locked .lock-badge { display: block; }
        .lock-badge svg { width: 100%; height: 100%; fill: none; stroke: currentColor; stroke-width: 2; }

        .search-container { margin-bottom: 24px; }
        .search-box { position: relative; }
        .search-input {
            width: 100%; padding: 16px 20px 16px 52px;
            background: var(--bg-card); border: 2px solid var(--border-color); border-radius: 14px;
            color: var(--text-primary); font-size: 1rem; outline: none; transition: all 0.3s ease;
        }
        .search-input::placeholder { color: var(--text-muted); }
        .search-input:focus { border-color: var(--energon-blue); box-shadow: 0 0 0 4px var(--energon-glow); }
        .search-icon { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); width: 20px; height: 20px; color: var(--text-muted); }
        .search-input:focus + .search-icon { color: var(--energon-blue); }
        .search-icon svg { width: 100%; height: 100%; fill: none; stroke: currentColor; stroke-width: 2; }
        .search-tip { margin-top: 10px; font-size: 0.8rem; color: var(--text-muted); }
        .search-tip .energon-highlight { color: var(--energon-blue); font-weight: 700; }
        .clear-search {
            position: absolute; right: 16px; top: 50%; transform: translateY(-50%);
            width: 24px; height: 24px; background: var(--bg-secondary); border: none; border-radius: 50%;
            color: var(--text-muted); cursor: pointer; display: none; align-items: center; justify-content: center;
        }
        .clear-search.visible { display: flex; }
        .clear-search:hover { background: var(--accent); color: white; }
        .clear-search svg { width: 14px; height: 14px; stroke: currentColor; fill: none; stroke-width: 2.5; }

        .member-list { display: flex; flex-direction: column; gap: 12px; }
        .member-card {
            display: flex; align-items: center; justify-content: space-between;
            padding: 18px 20px; background: var(--bg-card); border: 2px solid var(--border-color);
            border-radius: 16px; cursor: pointer; transition: all 0.3s ease; user-select: none; position: relative;
        }
        .member-card:hover { background: var(--bg-card-hover); transform: translateX(4px); border-color: #555; }
        .member-card:active { transform: scale(0.98); }
        .member-card.present { background: var(--present-bg); border-color: var(--present-border); box-shadow: 0 0 20px rgba(0, 255, 136, 0.15); }
        .member-card.present:hover { background: rgba(0, 255, 136, 0.18); }
        .member-card.absent { background: var(--absent-bg); border-color: var(--absent-border); box-shadow: 0 0 20px rgba(255, 68, 102, 0.15); }
        .member-card.absent:hover { background: rgba(255, 68, 102, 0.18); }
        .member-card.highlighted { border-color: var(--energon-blue); box-shadow: 0 0 35px var(--energon-glow); }
        .member-card.hidden { display: none; }

        .member-info { display: flex; align-items: center; gap: 16px; }
        .member-avatar {
            width: 52px; height: 52px;
            background: linear-gradient(135deg, var(--accent), #ff7a85);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            font-weight: 700; font-size: 1.2rem; color: white; box-shadow: 0 4px 20px var(--accent-glow);
        }
        .member-details { display: flex; flex-direction: column; }
        .member-name { font-size: 1.1rem; font-weight: 700; margin-bottom: 4px; }
        .member-id { font-size: 0.8rem; display: flex; align-items: center; gap: 6px; }
        .member-id .id-label { color: var(--text-secondary); font-weight: 500; }
        .member-id .id-value {
            font-family: 'Courier New', monospace; letter-spacing: 0.12em; font-weight: 700;
            color: var(--energon-blue); background: rgba(0, 229, 255, 0.1);
            padding: 3px 10px; border-radius: 5px; border: 1px solid rgba(0, 229, 255, 0.35);
        }
        .member-right { display: flex; align-items: center; gap: 14px; }

        .graph-btn {
            width: 36px; height: 36px; background: rgba(0, 229, 255, 0.1);
            border: 1px solid rgba(0, 229, 255, 0.3); border-radius: 8px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: all 0.3s ease; color: var(--energon-blue);
        }
        .graph-btn:hover {
            background: var(--energon-blue); color: #000;
            box-shadow: 0 0 20px var(--energon-glow);
        }
        .graph-btn svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; }

        .streak-badge {
            display: inline-flex; align-items: center; gap: 5px;
            padding: 7px 14px; border-radius: 20px; font-size: 0.78rem; font-weight: 700; white-space: nowrap;
        }
        .streak-badge.streak-0 { background: rgba(136, 136, 136, 0.15); color: #999; border: 1px solid #666; }
        .streak-badge.streak-1 { background: rgba(125, 255, 179, 0.15); color: var(--streak-1); border: 1px solid var(--streak-1); box-shadow: 0 0 15px rgba(125, 255, 179, 0.25); }
        .streak-badge.streak-2 { background: rgba(0, 255, 106, 0.15); color: var(--streak-2); border: 1px solid var(--streak-2); box-shadow: 0 0 15px rgba(0, 255, 106, 0.25); }
        .streak-badge.streak-3 { background: rgba(0, 180, 255, 0.15); color: var(--streak-3); border: 1px solid var(--streak-3); box-shadow: 0 0 15px rgba(0, 180, 255, 0.3); }
        .streak-badge.streak-4 { background: rgba(61, 122, 255, 0.18); color: #6d9fff; border: 1px solid var(--streak-4); box-shadow: 0 0 18px rgba(61, 122, 255, 0.35); }
        .streak-badge.streak-5 { background: rgba(255, 77, 106, 0.18); color: var(--streak-5); border: 1px solid var(--streak-5); box-shadow: 0 0 20px rgba(255, 77, 106, 0.4); animation: firePulse 1.2s infinite; }
        .streak-badge.streak-6 { background: var(--streak-6); color: #fff; border: 2px solid #fff; box-shadow: 0 0 20px rgba(255, 255, 255, 0.3); animation: firePulse 1.2s infinite; }
        @keyframes firePulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.06); } }
        .fire-icon { font-size: 0.95rem; animation: flicker 0.4s infinite alternate; }
        @keyframes flicker { 0% { opacity: 1; transform: scale(1) rotate(-5deg); } 100% { opacity: 0.85; transform: scale(1.15) rotate(5deg); } }

        .status-btn {
            display: flex; align-items: center; gap: 8px;
            padding: 10px 18px; border-radius: 10px; font-size: 0.8rem;
            font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; border: none; pointer-events: none;
        }
        .status-btn.absent { background: linear-gradient(135deg, var(--absent), var(--absent-dim)); color: white; box-shadow: 0 4px 20px var(--absent-glow); }
        .status-btn.present { background: linear-gradient(135deg, var(--present), var(--present-dim)); color: #003d22; box-shadow: 0 4px 20px var(--present-glow); }
        .status-indicator { width: 8px; height: 8px; border-radius: 50%; background: currentColor; animation: statusPulse 1.5s infinite; }
        @keyframes statusPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .no-results { display: none; flex-direction: column; align-items: center; padding: 60px 20px; text-align: center; }
        .no-results.visible { display: flex; }
        .no-results-icon { width: 80px; height: 80px; background: var(--bg-card); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; font-size: 2.5rem; border: 2px solid var(--border-color); }
        .no-results-text { font-size: 1.1rem; font-weight: 600; margin-bottom: 8px; }
        .no-results-sub { color: var(--text-muted); font-size: 0.9rem; }

        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px);
            display: none; align-items: center; justify-content: center; z-index: 1000;
            opacity: 0; transition: opacity 0.3s ease;
        }
        .modal-overlay.active { display: flex; opacity: 1; }

        .modal-content {
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 20px; padding: 30px; max-width: 500px; width: 90%;
            transform: scale(0.9); transition: transform 0.3s ease;
        }
        .modal-overlay.active .modal-content { transform: scale(1); }

        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
        .modal-title { font-size: 1.3rem; font-weight: 700; }
        .modal-close {
            width: 36px; height: 36px; background: var(--bg-secondary); border: 1px solid var(--border-color);
            border-radius: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; color: var(--text-muted);
            transition: all 0.3s ease;
        }
        .modal-close:hover { background: var(--accent); color: white; border-color: var(--accent); }
        .modal-close svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; }

        .confirm-body { text-align: center; padding: 20px 0; }
        .confirm-icon { font-size: 3rem; margin-bottom: 16px; }
        .confirm-text { font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 8px; }
        .confirm-name { font-size: 1.4rem; font-weight: 700; color: var(--present); margin-bottom: 24px; }
        .confirm-btns { display: flex; gap: 12px; justify-content: center; }
        .confirm-btn {
            padding: 14px 32px; border-radius: 12px; font-size: 0.9rem; font-weight: 700;
            border: none; cursor: pointer; transition: all 0.3s ease; text-transform: uppercase;
        }
        .confirm-btn.save { background: var(--present); color: #003d22; box-shadow: 0 4px 20px var(--present-glow); }
        .confirm-btn.save:hover { transform: translateY(-2px); box-shadow: 0 8px 30px var(--present-glow); }
        .confirm-btn.cancel { background: var(--bg-secondary); color: var(--text-secondary); border: 1px solid var(--border-color); }
        .confirm-btn.cancel:hover { border-color: var(--accent); color: var(--accent); }

        .graph-modal .modal-content { max-width: 650px; }
        .graph-member-info { display: flex; align-items: center; gap: 14px; margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid var(--border-color); }
        .graph-avatar { width: 50px; height: 50px; background: linear-gradient(135deg, var(--accent), #ff7a85); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 1.2rem; color: white; }
        .graph-member-name { font-size: 1.2rem; font-weight: 700; }
        .graph-member-id { font-size: 0.8rem; color: var(--energon-blue); }

        .graph-stats { display: flex; gap: 12px; margin-bottom: 24px; }
        .graph-stat { flex: 1; background: var(--bg-secondary); border-radius: 12px; padding: 14px; text-align: center; }
        .graph-stat-value { font-size: 1.6rem; font-weight: 800; }
        .graph-stat-value.present-val { color: var(--present); }
        .graph-stat-value.absent-val { color: var(--absent); }
        .graph-stat-label { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; margin-top: 4px; }

        .trend-indicator {
            flex: 1; background: var(--bg-secondary); border-radius: 12px; padding: 14px; text-align: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .trend-arrow { font-size: 1.4rem; margin-bottom: 4px; }
        .trend-arrow.up { color: var(--graph-up); animation: bounceUp 1s infinite; }
        .trend-arrow.down { color: var(--graph-down); animation: bounceDown 1s infinite; }
        .trend-text { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; }
        @keyframes bounceUp { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes bounceDown { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(5px); } }

        .graph-container { background: var(--bg-secondary); border-radius: 16px; padding: 20px; position: relative; }
        .graph-title { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.1em; display: flex; align-items: center; gap: 8px; }
        .graph-title-icon { font-size: 1rem; }

        .line-graph-wrapper { position: relative; height: 180px; margin: 10px 0; }
        .line-graph-svg { width: 100%; height: 100%; overflow: visible; }
        .graph-grid-line { stroke: var(--border-color); stroke-width: 1; stroke-dasharray: 4 4; }
        .graph-path { fill: none; stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; }
        .graph-path-up { stroke: var(--graph-up); filter: drop-shadow(0 0 8px var(--present-glow)); }
        .graph-path-down { stroke: var(--graph-down); filter: drop-shadow(0 0 8px var(--absent-glow)); }
        .graph-area { opacity: 0.15; }
        .graph-area-up { fill: var(--graph-up); }
        .graph-area-down { fill: var(--graph-down); }
        .graph-dot { r: 5; transition: all 0.2s ease; cursor: pointer; }
        .graph-dot:hover { r: 8; }
        .graph-dot-up { fill: var(--graph-up); filter: drop-shadow(0 0 6px var(--present-glow)); }
        .graph-dot-down { fill: var(--graph-down); filter: drop-shadow(0 0 6px var(--absent-glow)); }

        .graph-x-labels { display: flex; justify-content: space-between; margin-top: 8px; padding: 0 5px; }
        .graph-x-label { font-size: 0.65rem; color: var(--text-muted); }
        .graph-y-labels { position: absolute; left: -30px; top: 0; height: 100%; display: flex; flex-direction: column; justify-content: space-between; }
        .graph-y-label { font-size: 0.6rem; color: var(--text-muted); }

        .graph-legend { display: flex; justify-content: center; gap: 24px; margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-color); }
        .legend-item { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-secondary); }
        .legend-line { width: 24px; height: 3px; border-radius: 2px; }
        .legend-line.up-line { background: var(--graph-up); box-shadow: 0 0 8px var(--present-glow); }
        .legend-line.down-line { background: var(--graph-down); box-shadow: 0 0 8px var(--absent-glow); }

        .journey-message { text-align: center; margin-top: 16px; padding: 12px; background: rgba(0, 229, 255, 0.05); border: 1px solid rgba(0, 229, 255, 0.2); border-radius: 10px; }
        .journey-message p { font-size: 0.85rem; color: var(--energon-blue); }
        .journey-message .journey-icon { font-size: 1.1rem; margin-right: 6px; }

        .toast {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px);
            background: var(--present); color: #003d22; padding: 16px 28px; border-radius: 12px;
            font-weight: 700; font-size: 0.95rem; display: flex; align-items: center; gap: 10px;
            box-shadow: 0 8px 30px var(--present-glow); opacity: 0; transition: all 0.4s ease; z-index: 2000;
        }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast svg { width: 22px; height: 22px; stroke: currentColor; fill: none; stroke-width: 2.5; }

        .exit-fullscreen-btn {
            position: fixed; top: 20px; right: 20px;
            background: var(--accent); color: white; border: none; border-radius: 10px;
            padding: 12px 20px; font-weight: 700; cursor: pointer; z-index: 9999;
            display: none; align-items: center; gap: 8px; font-size: 0.85rem;
            box-shadow: 0 4px 20px var(--accent-glow);
        }
        .exit-fullscreen-btn svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 2; }
        :fullscreen .exit-fullscreen-btn { display: flex; }

        @media (max-width: 640px) {
            .section-title { font-size: 1.6rem; }
            .fullscreen-btn { position: static; margin: 0 auto 20px; }
            .section-header { flex-direction: column; }
            .days-row { grid-template-columns: repeat(3, 1fr); }
            .member-card { flex-wrap: wrap; gap: 12px; padding: 14px 16px; }
            .member-right { width: 100%; justify-content: space-between; }
            .graph-btn { width: 32px; height: 32px; }
            .modal-content { padding: 20px; }
            .line-graph-wrapper { height: 140px; }
            .confirm-btns { flex-direction: column; }
            .confirm-btn { width: 100%; }
            .graph-stats { flex-wrap: wrap; }
            .graph-stat, .trend-indicator { min-width: calc(50% - 6px); }
        }
    </style>
</head>
<body>
    <div class="attendance-section" id="attendanceSection">
        
        <header class="section-header">
            <h1 class="section-title">Member <span>Attendance</span></h1>
            <p class="section-subtitle">Track and manage daily member attendance</p>
            <button class="fullscreen-btn" id="fullscreenBtn">
                <svg viewBox="0 0 24 24"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                Fullscreen
            </button>
        </header>

        <div class="day-lock-container">
            <p class="day-lock-label">Weekly Schedule</p>
            <div class="days-row" id="daysRow"></div>
        </div>

        <div class="search-container">
            <div class="search-box">
                <input type="text" id="searchInput" class="search-input" placeholder="Search by Energon ID (e.g., 005)" autocomplete="off">
                <span class="search-icon"><svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg></span>
                <button class="clear-search" id="clearSearch"><svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
            </div>
            <p class="search-tip">‚ö° Enter <span class="energon-highlight">Energon ID</span> to locate a member instantly</p>
        </div>

        <div class="member-list" id="memberList"></div>

        <div class="no-results" id="noResults">
            <div class="no-results-icon">üîç</div>
            <p class="no-results-text">No member found</p>
            <p class="no-results-sub">Try searching with a different Energon ID</p>
        </div>
    </div>

    <button class="exit-fullscreen-btn" id="exitFullscreenBtn">
        <svg viewBox="0 0 24 24"><path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/></svg>
        Exit Fullscreen
    </button>

    <!-- Confirm Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Attendance</h3>
                <button class="modal-close" id="confirmClose"><svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
            </div>
            <div class="confirm-body">
                <div class="confirm-icon">‚úÖ</div>
                <p class="confirm-text">Save attendance for today?</p>
                <p class="confirm-name" id="confirmMemberName">MEMBER NAME</p>
                <div class="confirm-btns">
                    <button class="confirm-btn save" id="confirmSave">Save</button>
                    <button class="confirm-btn cancel" id="confirmCancel">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Graph Modal -->
    <div class="modal-overlay graph-modal" id="graphModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">üìà Progress Journey</h3>
                <button class="modal-close" id="graphClose"><svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg></button>
            </div>
            <div class="graph-member-info">
                <div class="graph-avatar" id="graphAvatar">A</div>
                <div>
                    <div class="graph-member-name" id="graphMemberName">ADITYA</div>
                    <div class="graph-member-id" id="graphMemberId">Energon ID: 001</div>
                </div>
            </div>
            <div class="graph-stats">
                <div class="graph-stat">
                    <div class="graph-stat-value present-val" id="graphPresent">18</div>
                    <div class="graph-stat-label">Present</div>
                </div>
                <div class="graph-stat">
                    <div class="graph-stat-value absent-val" id="graphAbsent">6</div>
                    <div class="graph-stat-label">Absent</div>
                </div>
                <div class="trend-indicator">
                    <span class="trend-arrow up" id="trendArrow">‚¨Ü</span>
                    <span class="trend-text" id="trendText">Improving</span>
                </div>
            </div>
            <div class="graph-container">
                <div class="graph-title"><span class="graph-title-icon">üìä</span> Monthly Attendance Flow</div>
                <div class="line-graph-wrapper">
                    <svg class="line-graph-svg" id="lineGraphSvg" viewBox="0 0 560 160" preserveAspectRatio="none"></svg>
                </div>
                <div class="graph-x-labels">
                    <span class="graph-x-label">Day 1</span>
                    <span class="graph-x-label">Day 10</span>
                    <span class="graph-x-label">Day 20</span>
                    <span class="graph-x-label">Day 30</span>
                </div>
                <div class="graph-legend">
                    <div class="legend-item"><div class="legend-line up-line"></div> Improvement ‚¨Ü</div>
                    <div class="legend-item"><div class="legend-line down-line"></div> Decline ‚¨á</div>
                </div>
            </div>
            <div class="journey-message" id="journeyMessage">
                <p><span class="journey-icon">üí™</span> <span id="journeyText">Keep pushing! Your consistency is building.</span></p>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
        <span id="toastText">Attendance saved!</span>
    </div>

    <script>
        (function() {
            'use strict';

            const DAYS = ['MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];

            const INITIAL_MEMBERS = [
                { id: 1,  name: 'ADITYA',   streak: 3, present: false },
                { id: 2,  name: 'VAISHNAV', streak: 5, present: false },
                { id: 3,  name: 'AKSHAT',   streak: 1, present: false },
                { id: 4,  name: 'ADARSH',   streak: 6, present: false },
                { id: 5,  name: 'GEETA',    streak: 2, present: false },
                { id: 6,  name: 'SURAJ',    streak: 4, present: false },
                { id: 7,  name: 'SAKSHI',   streak: 0, present: false },
                { id: 8,  name: 'SUMAN',    streak: 5, present: false },
                { id: 9,  name: 'KASHISH',  streak: 2, present: false },
                { id: 10, name: 'SANVI',    streak: 4, present: false }
            ];

            // Generate monthly attendance data - creates a progress journey
            function generateMonthlyData(memberId) {
                const data = [];
                const patterns = [
                    [1,1,1,0,1,1,0,1,1,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1], // Good
                    [0,1,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1], // Improving
                    [1,1,1,1,1,0,1,1,0,1,0,1,1,0,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1], // Inconsistent
                    [1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1], // Excellent
                    [0,0,1,0,1,1,0,1,0,1,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1], // Starting slow
                    [1,1,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,1], // Steady
                    [0,0,0,1,0,1,0,1,1,0,1,0,1,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,1,0], // Struggling
                    [1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1], // Great
                    [0,1,1,0,1,0,1,1,0,1,1,1,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,0,1], // Mixed
                    [1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1]  // Strong
                ];
                return patterns[(memberId - 1) % patterns.length];
            }

            // Calculate cumulative progress for smooth line
            function calculateProgress(data) {
                const progress = [];
                let score = 50; // Start at middle
                data.forEach((day, i) => {
                    if (day) {
                        score = Math.min(100, score + 3 + Math.random() * 2);
                    } else {
                        score = Math.max(0, score - 4 - Math.random() * 2);
                    }
                    progress.push({ day: i + 1, score: score, present: day });
                });
                return progress;
            }

            // Generate smooth bezier curve path
            function generateSmoothPath(points, width, height) {
                if (points.length < 2) return '';
                
                const xScale = width / (points.length - 1);
                const yScale = height / 100;
                
                const scaledPoints = points.map((p, i) => ({
                    x: i * xScale,
                    y: height - (p.score * yScale),
                    score: p.score,
                    present: p.present
                }));

                // Create smooth bezier curve
                let path = `M ${scaledPoints[0].x} ${scaledPoints[0].y}`;
                
                for (let i = 0; i < scaledPoints.length - 1; i++) {
                    const p0 = scaledPoints[i];
                    const p1 = scaledPoints[i + 1];
                    
                    const tension = 0.3;
                    const cp1x = p0.x + (p1.x - p0.x) * tension;
                    const cp1y = p0.y;
                    const cp2x = p1.x - (p1.x - p0.x) * tension;
                    const cp2y = p1.y;
                    
                    path += ` C ${cp1x} ${cp1y}, ${cp2x} ${cp2y}, ${p1.x} ${p1.y}`;
                }
                
                return { path, points: scaledPoints };
            }

            let members = JSON.parse(JSON.stringify(INITIAL_MEMBERS));
            let currentSearchId = null;
            let pendingMemberId = null;

            const elements = {
                daysRow: document.getElementById('daysRow'),
                searchInput: document.getElementById('searchInput'),
                clearSearch: document.getElementById('clearSearch'),
                memberList: document.getElementById('memberList'),
                noResults: document.getElementById('noResults'),
                fullscreenBtn: document.getElementById('fullscreenBtn'),
                exitFullscreenBtn: document.getElementById('exitFullscreenBtn'),
                confirmModal: document.getElementById('confirmModal'),
                confirmClose: document.getElementById('confirmClose'),
                confirmSave: document.getElementById('confirmSave'),
                confirmCancel: document.getElementById('confirmCancel'),
                confirmMemberName: document.getElementById('confirmMemberName'),
                graphModal: document.getElementById('graphModal'),
                graphClose: document.getElementById('graphClose'),
                graphAvatar: document.getElementById('graphAvatar'),
                graphMemberName: document.getElementById('graphMemberName'),
                graphMemberId: document.getElementById('graphMemberId'),
                graphPresent: document.getElementById('graphPresent'),
                graphAbsent: document.getElementById('graphAbsent'),
                lineGraphSvg: document.getElementById('lineGraphSvg'),
                trendArrow: document.getElementById('trendArrow'),
                trendText: document.getElementById('trendText'),
                journeyText: document.getElementById('journeyText'),
                toast: document.getElementById('toast'),
                toastText: document.getElementById('toastText')
            };

            function formatEnergonId(id) { return String(id).padStart(3, '0'); }

            function getCurrentDayIndex() {
                const jsDay = new Date().getDay();
                return jsDay === 0 ? -1 : jsDay - 1;
            }

            function canEditAttendance() {
                const currentDay = getCurrentDayIndex();
                return currentDay >= 0 && currentDay <= 5;
            }

            function getStreakClass(streak) {
                if (streak <= 0) return 'streak-0';
                if (streak >= 6) return 'streak-6';
                return `streak-${streak}`;
            }

            function getStreakBadgeHTML(streak) {
                const streakClass = getStreakClass(streak);
                const fireIcon = streak >= 5 ? '<span class="fire-icon">üî•</span>' : '';
                const dayText = streak === 1 ? 'Day' : 'Days';
                return `<span class="streak-badge ${streakClass}">${fireIcon}${streak} ${dayText}</span>`;
            }

            function showToast(message) {
                elements.toastText.textContent = message;
                elements.toast.classList.add('show');
                setTimeout(() => elements.toast.classList.remove('show'), 3000);
            }

            function enterFullscreen() {
                const elem = document.documentElement;
                if (elem.requestFullscreen) elem.requestFullscreen();
                else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
                else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
            }

            function exitFullscreen() {
                if (document.exitFullscreen) document.exitFullscreen();
                else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
                else if (document.msExitFullscreen) document.msExitFullscreen();
            }

            function openModal(modalEl) {
                modalEl.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeModal(modalEl) {
                modalEl.classList.remove('active');
                document.body.style.overflow = '';
            }

            function showConfirmModal(memberId) {
                const member = members.find(m => m.id === memberId);
                if (!member) return;
                pendingMemberId = memberId;
                elements.confirmMemberName.textContent = member.name;
                openModal(elements.confirmModal);
            }

            function confirmSaveAttendance() {
                if (pendingMemberId === null) return;
                
                const memberIndex = members.findIndex(m => m.id === pendingMemberId);
                if (memberIndex !== -1) {
                    const member = members[memberIndex];
                    member.present = !member.present;
                    
                    if (member.present) {
                        member.streak = Math.min(6, member.streak + 1);
                    } else {
                        member.streak = Math.max(0, member.streak - 1);
                    }

                    renderMemberList();
                    if (currentSearchId !== null) highlightMember(currentSearchId);
                    
                    showToast(`${member.name} marked as ${member.present ? 'Present' : 'Absent'}!`);
                }
                
                closeModal(elements.confirmModal);
                pendingMemberId = null;
            }

            function showGraphModal(memberId) {
                const member = members.find(m => m.id === memberId);
                if (!member) return;

                elements.graphAvatar.textContent = member.name.charAt(0);
                elements.graphMemberName.textContent = member.name;
                elements.graphMemberId.textContent = `Energon ID: ${formatEnergonId(member.id)}`;

                const monthlyData = generateMonthlyData(memberId);
                const presentCount = monthlyData.filter(d => d).length;
                const absentCount = monthlyData.length - presentCount;

                elements.graphPresent.textContent = presentCount;
                elements.graphAbsent.textContent = absentCount;

                // Calculate progress and trend
                const progress = calculateProgress(monthlyData);
                const firstHalf = progress.slice(0, 15).reduce((a, b) => a + b.score, 0) / 15;
                const secondHalf = progress.slice(15).reduce((a, b) => a + b.score, 0) / 15;
                const isImproving = secondHalf > firstHalf;

                // Update trend indicator
                elements.trendArrow.textContent = isImproving ? '‚¨Ü' : '‚¨á';
                elements.trendArrow.className = `trend-arrow ${isImproving ? 'up' : 'down'}`;
                elements.trendText.textContent = isImproving ? 'Improving' : 'Needs Focus';

                // Journey message
                const messages = isImproving 
                    ? ['Great progress! Keep the momentum going! üöÄ', 'Your dedication is paying off! üí™', 'Excellent improvement trend! ‚≠ê']
                    : ['Every day is a new opportunity! üåü', 'Small steps lead to big changes! üí´', 'Stay focused, you got this! üéØ'];
                elements.journeyText.textContent = messages[Math.floor(Math.random() * messages.length)];

                // Render smooth line graph
                renderLineGraph(progress);

                openModal(elements.graphModal);
            }

            function renderLineGraph(progress) {
                const svg = elements.lineGraphSvg;
                const width = 560;
                const height = 140;
                const padding = 10;
                
                const { path, points } = generateSmoothPath(progress, width - padding * 2, height - padding * 2);
                
                // Create gradient definitions
                let svgContent = `
                    <defs>
                        <linearGradient id="lineGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#00ff88;stop-opacity:1" />
                            <stop offset="100%" style="stop-color:#00e5ff;stop-opacity:1" />
                        </linearGradient>
                        <linearGradient id="areaGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                            <stop offset="0%" style="stop-color:#00ff88;stop-opacity:0.3" />
                            <stop offset="100%" style="stop-color:#00ff88;stop-opacity:0" />
                        </linearGradient>
                    </defs>
                `;
                
                // Grid lines
                for (let i = 0; i <= 4; i++) {
                    const y = padding + (height - padding * 2) * i / 4;
                    svgContent += `<line x1="${padding}" y1="${y}" x2="${width - padding}" y2="${y}" class="graph-grid-line" />`;
                }
                
                // Area fill under the curve
                const areaPath = `${path} L ${points[points.length - 1].x} ${height - padding} L ${padding} ${height - padding} Z`;
                svgContent += `<path d="${areaPath}" fill="url(#areaGradient)" />`;
                
                // Draw colored segments based on direction
                for (let i = 0; i < points.length - 1; i++) {
                    const p1 = points[i];
                    const p2 = points[i + 1];
                    const isUp = p2.score >= p1.score;
                    const color = isUp ? 'var(--graph-up)' : 'var(--graph-down)';
                    const glow = isUp ? 'var(--present-glow)' : 'var(--absent-glow)';
                    
                    const tension = 0.3;
                    const cp1x = p1.x + (p2.x - p1.x) * tension;
                    const cp2x = p2.x - (p2.x - p1.x) * tension;
                    
                    svgContent += `<path d="M ${p1.x + padding} ${p1.y + padding} C ${cp1x + padding} ${p1.y + padding}, ${cp2x + padding} ${p2.y + padding}, ${p2.x + padding} ${p2.y + padding}" 
                        fill="none" stroke="${color}" stroke-width="3" stroke-linecap="round"
                        style="filter: drop-shadow(0 0 6px ${glow})" />`;
                }
                
                // Draw points at key intervals
                points.forEach((p, i) => {
                    if (i % 5 === 0 || i === points.length - 1) {
                        const color = p.present ? 'var(--graph-up)' : 'var(--graph-down)';
                        const glowColor = p.present ? 'var(--present-glow)' : 'var(--absent-glow)';
                        svgContent += `<circle cx="${p.x + padding}" cy="${p.y + padding}" r="5" fill="${color}" 
                            style="filter: drop-shadow(0 0 4px ${glowColor})" />`;
                    }
                });
                
                // Direction arrows at key points
                const arrowPoints = [7, 14, 21, 28];
                arrowPoints.forEach(idx => {
                    if (idx < points.length) {
                        const p = points[idx];
                        const prevP = points[idx - 1];
                        const isUp = p.score > prevP.score;
                        const arrow = isUp ? '‚ñ≤' : '‚ñº';
                        const color = isUp ? 'var(--graph-up)' : 'var(--graph-down)';
                        const yOffset = isUp ? -15 : 15;
                        svgContent += `<text x="${p.x + padding}" y="${p.y + padding + yOffset}" 
                            fill="${color}" font-size="10" text-anchor="middle" font-weight="bold">${arrow}</text>`;
                    }
                });
                
                svg.innerHTML = svgContent;
            }

            function renderDayLockSystem() {
                const currentDayIndex = getCurrentDayIndex();
                elements.daysRow.innerHTML = DAYS.map((day, index) => {
                    let statusClass = '', statusText = '';
                    if (currentDayIndex === -1 || index < currentDayIndex) {
                        statusClass = 'locked'; statusText = 'Locked';
                    } else if (index === currentDayIndex) {
                        statusClass = 'current'; statusText = 'Active';
                    } else {
                        statusClass = 'future'; statusText = 'Upcoming';
                    }
                    return `
                        <div class="day-cell ${statusClass}">
                            <span class="lock-badge"><svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg></span>
                            <span class="day-name">${day}</span>
                            <span class="day-cell-status">${statusText}</span>
                        </div>`;
                }).join('');
            }

            function renderMemberList() {
                elements.memberList.innerHTML = members.map(member => {
                    const statusClass = member.present ? 'present' : 'absent';
                    const statusText = member.present ? 'Present' : 'Absent';
                    const highlightClass = currentSearchId === member.id ? 'highlighted' : '';
                    const energonId = formatEnergonId(member.id);

                    return `
                        <div class="member-card ${statusClass} ${highlightClass}" data-id="${member.id}" role="button" tabindex="0">
                            <div class="member-info">
                                <div class="member-avatar">${member.name.charAt(0)}</div>
                                <div class="member-details">
                                    <div class="member-name">${member.name}</div>
                                    <div class="member-id">
                                        <span class="id-label">Energon ID:</span>
                                        <span class="id-value">${energonId}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="member-right">
                                <button class="graph-btn" data-graph-id="${member.id}" title="View Progress Journey">
                                    <svg viewBox="0 0 24 24"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
                                </button>
                                ${getStreakBadgeHTML(member.streak)}
                                <div class="status-btn ${statusClass}">
                                    <span class="status-indicator"></span>
                                    ${statusText}
                                </div>
                            </div>
                        </div>`;
                }).join('');

                attachMemberCardListeners();
            }

            function attachMemberCardListeners() {
                document.querySelectorAll('.member-card').forEach(card => {
                    card.addEventListener('click', (e) => {
                        if (e.target.closest('.graph-btn')) return;
                        if (canEditAttendance()) {
                            const id = parseInt(card.dataset.id);
                            showConfirmModal(id);
                        }
                    });

                    card.addEventListener('keydown', (e) => {
                        if ((e.key === 'Enter' || e.key === ' ') && canEditAttendance()) {
                            e.preventDefault();
                            const id = parseInt(card.dataset.id);
                            showConfirmModal(id);
                        }
                    });
                });

                document.querySelectorAll('.graph-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const id = parseInt(btn.dataset.graphId);
                        showGraphModal(id);
                    });
                });
            }

            function handleSearch(query) {
                const trimmedQuery = query.trim();
                const searchId = parseInt(trimmedQuery);
                elements.clearSearch.classList.toggle('visible', trimmedQuery.length > 0);
                document.querySelectorAll('.member-card').forEach(card => card.classList.remove('hidden', 'highlighted'));

                if (trimmedQuery === '') {
                    currentSearchId = null;
                    elements.noResults.classList.remove('visible');
                    return;
                }

                if (isNaN(searchId)) {
                    document.querySelectorAll('.member-card').forEach(card => card.classList.add('hidden'));
                    elements.noResults.classList.add('visible');
                    currentSearchId = null;
                    return;
                }

                const matchingMember = members.find(m => m.id === searchId);
                if (matchingMember) {
                    document.querySelectorAll('.member-card').forEach(card => {
                        if (parseInt(card.dataset.id) !== searchId) card.classList.add('hidden');
                    });
                    highlightMember(searchId);
                    currentSearchId = searchId;
                    elements.noResults.classList.remove('visible');
                } else {
                    document.querySelectorAll('.member-card').forEach(card => card.classList.add('hidden'));
                    elements.noResults.classList.add('visible');
                    currentSearchId = null;
                }
            }

            function highlightMember(id) {
                const card = document.querySelector(`.member-card[data-id="${id}"]`);
                if (card) {
                    card.classList.add('highlighted');
                    card.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            function clearSearch() {
                elements.searchInput.value = '';
                currentSearchId = null;
                elements.clearSearch.classList.remove('visible');
                elements.noResults.classList.remove('visible');
                document.querySelectorAll('.member-card').forEach(card => card.classList.remove('hidden', 'highlighted'));
                elements.searchInput.focus();
            }

            function initEventListeners() {
                elements.searchInput.addEventListener('input', (e) => handleSearch(e.target.value));
                elements.clearSearch.addEventListener('click', clearSearch);
                elements.searchInput.addEventListener('keydown', (e) => { if (e.key === 'Escape') clearSearch(); });

                elements.fullscreenBtn.addEventListener('click', enterFullscreen);
                elements.exitFullscreenBtn.addEventListener('click', exitFullscreen);

                elements.confirmClose.addEventListener('click', () => closeModal(elements.confirmModal));
                elements.confirmCancel.addEventListener('click', () => closeModal(elements.confirmModal));
                elements.confirmSave.addEventListener('click', confirmSaveAttendance);

                elements.graphClose.addEventListener('click', () => closeModal(elements.graphModal));

                elements.confirmModal.addEventListener('click', (e) => {
                    if (e.target === elements.confirmModal) closeModal(elements.confirmModal);
                });
                elements.graphModal.addEventListener('click', (e) => {
                    if (e.target === elements.graphModal) closeModal(elements.graphModal);
                });

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        closeModal(elements.confirmModal);
                        closeModal(elements.graphModal);
                    }
                });
            }

            function init() {
                renderDayLockSystem();
                renderMemberList();
                initEventListeners();
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }

            window.AttendanceSection = {
                getMembers: () => JSON.parse(JSON.stringify(members)),
                resetAttendance: () => { members.forEach(m => m.present = false); renderMemberList(); },
                getSummary: () => ({
                    total: members.length,
                    present: members.filter(m => m.present).length,
                    absent: members.filter(m => !m.present).length
                })
            };
        })();
    </script>
</body>
</html>